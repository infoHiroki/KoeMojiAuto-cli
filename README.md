# KoeMojiAuto

音声・動画ファイルから自動で文字起こしを行うCLIツール。

## 📋 導入前の確認

### システム要件
- Windows 10/11
- Python 3.9以上（[公式サイト](https://www.python.org/)からダウンロード）
- メモリ 8GB以上推奨
- ストレージ 5GB以上の空き容量

### 初回起動時の注意
- AIモデルの初回ダウンロード（約3GB）に10-30分かかる
- ウイルス対策ソフトが警告を出す場合があるが問題ない

## 🚀 インストール

### 自動インストール（推奨）
1. `install.bat`を実行する
2. 「Setup Complete!」と表示されれば完了

### 手動インストール（自動インストールが失敗した場合）
1. コマンドプロンプトを開く
2. `pip install -r requirements.txt`を実行する
3. エラーが出た場合はPythonのPATH設定を確認する

## 🎬 初回セットアップと起動

### ショートカットの作成
1. `create_shortcut.bat`を実行する
2. デスクトップにショートカットが作成される
3. ショートカットを使いやすい場所（タスクバーなど）に移動する

### 初回起動
1. 作成したショートカットをダブルクリックする（または`run.bat`を直接実行）
2. 以下のフォルダが自動作成される：
   - `input/` - 音声ファイルを入れる場所
   - `output/` - 文字起こし結果の保存場所
   - `archive/` - 処理済みファイルの保管場所
3. メニューが表示される
4. 初回はAIモデルのダウンロードが始まる（10-30分待つ）

## 📝 基本的な使い方

### 文字起こしの手順
1. `input/`フォルダに音声・動画ファイルを入れる
2. ショートカットから起動する（すでに起動している場合は不要）
3. メニューから「1」を入力して開始する4. 処理が完了すると`output/`フォルダにテキストファイルが作成される
5. 元ファイルは`archive/`フォルダに自動で移動する

### 対応ファイル形式
- 音声：MP3, WAV, M4A, FLAC, OGG, AAC
- 動画：MP4, MOV, AVI

### 処理時間の目安
**一般的なPC（Core i5、8GB RAM）**
- 10分の音声：約10-15分かかる
- 1時間の音声：約60-90分かかる

**高性能PC（Core i7/i9、16GB RAM以上）**
- 10分の音声：約5-8分で完了する
- 1時間の音声：約30-50分で完了する

## ⚙️ 設定のカスタマイズ

`config.json`を編集して動作を変更できる：

### 処理速度の調整
```json
{
  "whisper_model": "medium"  // small/medium/large から選ぶ
}
```
- `small`: 最速だが精度が低い
- `medium`: バランス型（推奨）
- `large`: 最高精度だが処理が遅い

### 言語の変更
```json
{
  "language": "en"  // 英語の場合（日本語は"ja"）
}
```

### スキャン間隔の変更
```json
{
  "scan_interval_minutes": 10  // 10分ごとにフォルダをチェックする
}
```

### その他の設定
- `max_cpu_percent`: CPU使用率の上限（デフォルト95%）

## 🔧 トラブルシューティング

### インストール時の問題| 症状 | 対処法 |
|------|--------|
| Pythonが見つからない | PythonをPATHに追加して再インストールする |
| pip installが失敗する | 管理者権限でコマンドプロンプトを実行する |
| ネットワークエラー | プロキシ設定を確認する |

### 実行時の問題
| 症状 | 対処法 |
|------|--------|
| ファイルが処理されない | 対応形式か確認し、メニューで「1」を押す |
| 処理が遅い | `whisper_model`を`small`に変更する |
| 文字化けする | テキストエディタをUTF-8対応のものに変える |
| メモリ不足エラー | 他のアプリを終了する |
| 初回起動が終わらない | AIモデルのダウンロード中なので30分程度待つ |

### ログの確認
問題が解決しない場合は`koemoji.log`を確認する。
ログが大きくなりすぎた場合は削除する。

## 💡 使用例とヒント

### 適している用途
- 会議の議事録作成
- インタビューの文字起こし
- 講演会の記録
- 動画の字幕作成
- 24時間365日の自動処理

### 適さない用途
- リアルタイム文字起こし（録音と同時に表示）
- ストリーミング音声の処理
- 1日100ファイル以上の大量処理
- 複数言語が混在する音声

### 便利な使い方
- 夜間に大量処理：PCをスリープさせずに放置する
- 定期的な処理：タスクスケジューラーと組み合わせる
- フォルダ監視：30分ごとに自動でファイルをチェックする

### OneDriveでの注意点
- 同期中のファイルは処理できない場合がある
- 処理完了まで同期を一時停止することを推奨する
## 📊 技術仕様

- 使用AI：OpenAI Whisper（faster-whisper実装）
- 処理方式：ローカル処理（インターネット不要）
- CPU使用率制限：95%（他の作業に影響しないよう制御）

## 🐛 問題が解決しない場合

1. `koemoji.log`でエラー内容を確認する
2. [GitHub Issues](https://github.com/infoHiroki/KoeMojiAuto-cli/issues)で同様の問題を検索する
3. 新しい問題の場合はIssueを作成する

## 📞 サポート

- GitHub Issues: https://github.com/infoHiroki/KoeMojiAuto-cli/issues
- 技術詳細: https://infohiroki.github.io/KoeMojiAuto-cli/
