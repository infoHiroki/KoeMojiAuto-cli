<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>KoeMojiAuto ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            line-height: 1.6;
            color: #333;
            background: #1a1a1a;
            min-height: 100vh;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }
        
        .header {
            text-align: center;
            color: white;
            margin-bottom: 30px;
        }
        
        .header h1 {
            font-size: 2.5em;
            margin-bottom: 10px;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
        }
        
        .tech-stack {
            background: white;
            border-radius: 10px;
            padding: 20px;
            margin-bottom: 30px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.2);
        }
        
        .tech-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-top: 20px;
        }
        
        .tech-item {
            background: #f8f9fa;
            padding: 15px;
            border-radius: 8px;
            border-left: 4px solid #333;
            transition: transform 0.3s ease;
        }
        
        .tech-item:hover {
            transform: translateY(-5px);
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
        }
        
        .tech-item h4 {
            color: #333;
            margin-bottom: 10px;
        }
        
        .architecture-diagram {
            background: white;
            border-radius: 10px;
            padding: 30px;
            margin-bottom: 30px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.2);
            text-align: center;
        }
        
        .flow-container {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 20px;
            margin: 30px 0;
        }
        
        .flow-step {
            background: linear-gradient(45deg, #333, #555);
            color: white;
            padding: 20px 30px;
            border-radius: 15px;
            min-width: 200px;
            text-align: center;
            position: relative;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 5px 15px rgba(0,0,0,0.3);
        }
        
        .flow-step:hover {
            transform: scale(1.05);
            box-shadow: 0 8px 25px rgba(0,0,0,0.3);
        }
        
        .flow-step::after {
            content: 'â†“';
            position: absolute;
            bottom: -30px;
            left: 50%;
            transform: translateX(-50%);
            font-size: 24px;
            color: #333;
            font-weight: bold;
        }
        
        .flow-step:last-child::after {
            display: none;
        }
        
        .component-details {
            background: white;
            border-radius: 10px;
            padding: 25px;
            margin-bottom: 30px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.2);
        }
        
        .component-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin-top: 20px;
        }
        
        .component {
            background: #f8f9fa;
            border-radius: 10px;
            padding: 20px;
            border: 2px solid transparent;
            transition: all 0.3s ease;
            cursor: pointer;
        }
        
        .component:hover {
            border-color: #333;
            background: #f0f0f0;
        }
        
        .component h3 {
            color: #333;
            margin-bottom: 15px;
            display: flex;
            align-items: center;
        }
        
        .component .icon {
            margin-right: 10px;
            font-size: 1.2em;
        }
        
        .code-example {
            background: #282c34;
            color: #abb2bf;
            padding: 15px;
            border-radius: 5px;
            margin: 10px 0;
            font-family: 'Courier New', monospace;
            font-size: 14px;
            overflow-x: auto;
        }
        
        .highlight {
            background: rgba(0, 0, 0, 0.1);
            padding: 2px 4px;
            border-radius: 3px;
            color: #333;
            font-weight: bold;
        }
        
        .modal {
            display: none;
            position: fixed;
            z-index: 1000;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.5);
        }
        
        .modal-content {
            background: white;
            margin: 10% auto;
            padding: 30px;
            border-radius: 10px;
            width: 80%;
            max-width: 600px;
            position: relative;
        }
        
        .close {
            position: absolute;
            right: 15px;
            top: 15px;
            font-size: 28px;
            cursor: pointer;
            color: #aaa;
        }
        
        .close:hover {
            color: #333;
        }
        
        @media (max-width: 768px) {
            .container { padding: 10px; }
            .header h1 { font-size: 2em; }
            .flow-container { gap: 15px; }
            .flow-step { min-width: 150px; padding: 15px 20px; }
        }
        
        /* ãƒ­ã‚´ãƒŠãƒ“ã‚²ãƒ¼ã‚·ãƒ§ãƒ³ */
        .logo-nav {
            position: fixed;
            top: 20px;
            left: 20px;
            width: 50px;
            height: 50px;
            background: white;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            box-shadow: 0 2px 10px rgba(0,0,0,0.3);
            z-index: 1000;
            transition: transform 0.3s ease;
            text-decoration: none;
        }
        
        .logo-nav:hover {
            transform: scale(1.1);
        }
        
        .logo-nav img {
            width: 30px;
            height: 30px;
        }
    </style>
</head>
<body>
    <!-- ãƒ­ã‚´ãƒŠãƒ“ã‚²ãƒ¼ã‚·ãƒ§ãƒ³ -->
    <a href="index.html" class="logo-nav">
        <img src="icon.png" alt="KoeMojiAuto">
    </a>
    
    <div class="container">
        <div class="header">
            <h1>ğŸ¤ KoeMojiAuto</h1>
            <h2>éŸ³å£°æ–‡å­—èµ·ã“ã—ã‚·ã‚¹ãƒ†ãƒ  ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£</h2>
        </div>

        <!-- æŠ€è¡“ã‚¹ã‚¿ãƒƒã‚¯ -->
        <div class="tech-stack">
            <h2>ğŸ› ï¸ æŠ€è¡“ã‚¹ã‚¿ãƒƒã‚¯</h2>
            <div class="tech-grid">
                <div class="tech-item">
                    <h4>ğŸ Python 3.8+</h4>
                    <p>ãƒ¡ã‚¤ãƒ³é–‹ç™ºè¨€èªã€‚éåŒæœŸå‡¦ç†ã€ãƒ•ã‚¡ã‚¤ãƒ«æ“ä½œã€ã‚·ã‚¹ãƒ†ãƒ çµ±åˆã«ä½¿ç”¨</p>
                </div>
                <div class="tech-item">
                    <h4>ğŸ§ faster-whisper</h4>
                    <p>OpenAI Whisperã®é«˜é€Ÿå®Ÿè£…ã€‚éŸ³å£°èªè­˜ã®ã‚³ã‚¢ã‚¨ãƒ³ã‚¸ãƒ³ï¼ˆINT8é‡å­åŒ–å¯¾å¿œï¼‰</p>
                </div>
                <div class="tech-item">
                    <h4>âš¡ psutil</h4>
                    <p>ã‚·ã‚¹ãƒ†ãƒ ãƒªã‚½ãƒ¼ã‚¹ç›£è¦–ã€‚CPUä½¿ç”¨ç‡åˆ¶å¾¡ã¨ãƒ—ãƒ­ã‚»ã‚¹ç®¡ç†</p>
                </div>
                <div class="tech-item">
                    <h4>ğŸ§µ threading</h4>
                    <p>ä¸¦è¡Œå‡¦ç†åˆ¶å¾¡ã€‚ãƒ•ã‚¡ã‚¤ãƒ«ç›£è¦–ã¨å‡¦ç†ã®åˆ†é›¢</p>
                </div>
            </div>
        </div>

        <!-- ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£å›³ -->
        <div class="architecture-diagram">
            <h2>ğŸ—ï¸ ã‚·ã‚¹ãƒ†ãƒ ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£</h2>
            <div class="flow-container">
                <div class="flow-step" onclick="showDetail('input')">
                    ğŸ“ INPUT ãƒ•ã‚©ãƒ«ãƒ€<br>
                    <small>éŸ³å£°ãƒ»å‹•ç”»ãƒ•ã‚¡ã‚¤ãƒ«é…ç½®</small>
                </div>
                <div class="flow-step" onclick="showDetail('scanner')">
                    ğŸ” ãƒ•ã‚¡ã‚¤ãƒ«ç›£è¦–<br>
                    <small>å®šæœŸã‚¹ã‚­ãƒ£ãƒ³ï¼ˆ30åˆ†é–“éš”ï¼‰</small>
                </div>
                <div class="flow-step" onclick="showDetail('queue')">
                    ğŸ“‹ å‡¦ç†ã‚­ãƒ¥ãƒ¼<br>
                    <small>ãƒ•ã‚¡ã‚¤ãƒ«ãƒªã‚¹ãƒˆç®¡ç†</small>
                </div>
                <div class="flow-step" onclick="showDetail('whisper')">
                    ğŸ¤– Whisper ã‚¨ãƒ³ã‚¸ãƒ³<br>
                    <small>éŸ³å£°èªè­˜å‡¦ç†ï¼ˆINT8/FP16ï¼‰</small>
                </div>
                <div class="flow-step" onclick="showDetail('output')">
                    ğŸ“„ OUTPUT ãƒ•ã‚©ãƒ«ãƒ€<br>
                    <small>ãƒ†ã‚­ã‚¹ãƒˆçµæœå‡ºåŠ›</small>
                </div>
                <div class="flow-step" onclick="showDetail('archive')">
                    ğŸ—ƒï¸ ARCHIVE ãƒ•ã‚©ãƒ«ãƒ€<br>
                    <small>å‡¦ç†æ¸ˆã¿ãƒ•ã‚¡ã‚¤ãƒ«ä¿ç®¡</small>
                </div>
            </div>
        </div>

        <!-- ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆè©³ç´° -->
        <div class="component-details">
            <h2>âš™ï¸ ä¸»è¦ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆ</h2>
            <div class="component-grid">
                <div class="component" onclick="showCode('fileWatcher')">
                    <h3><span class="icon">ğŸ‘ï¸</span>ãƒ•ã‚¡ã‚¤ãƒ«ç›£è¦–ã‚·ã‚¹ãƒ†ãƒ </h3>
                    <p><span class="highlight">scan_and_queue_files()</span></p>
                    <p>â€¢ å®šæœŸçš„ãªå…¥åŠ›ãƒ•ã‚©ãƒ«ãƒ€ã‚¹ã‚­ãƒ£ãƒ³</p>
                    <p>â€¢ å¯¾å¿œå½¢å¼ãƒ•ã‚£ãƒ«ã‚¿ãƒªãƒ³ã‚°</p>
                    <p>â€¢ é‡è¤‡å‡¦ç†é˜²æ­¢</p>
                </div>
                
                <div class="component" onclick="showCode('queueManager')">
                    <h3><span class="icon">ğŸ“Š</span>ã‚­ãƒ¥ãƒ¼ç®¡ç†</h3>
                    <p><span class="highlight">processing_queue</span></p>
                    <p>â€¢ FIFOæ–¹å¼ã®ãƒ•ã‚¡ã‚¤ãƒ«å‡¦ç†</p>
                    <p>â€¢ ãƒ¡ã‚¿ãƒ‡ãƒ¼ã‚¿ä»˜ãã‚­ãƒ¥ãƒ¼ã‚¤ãƒ³ã‚°</p>
                    <p>â€¢ åŒæ™‚å‡¦ç†æ•°åˆ¶å¾¡</p>
                </div>
                
                <div class="component" onclick="showCode('whisperIntegration')">
                    <h3><span class="icon">ğŸ¤</span>éŸ³å£°èªè­˜ã‚¨ãƒ³ã‚¸ãƒ³</h3>
                    <p><span class="highlight">transcribe_audio()</span></p>
                    <p>â€¢ Whisperãƒ¢ãƒ‡ãƒ«ç®¡ç†</p>
                    <p>â€¢ æ—¥æœ¬èªéŸ³å£°èªè­˜</p>
                    <p>â€¢ ã‚»ã‚°ãƒ¡ãƒ³ãƒˆå˜ä½å‡¦ç†</p>
                </div>
                
                <div class="component" onclick="showCode('resourceManager')">
                    <h3><span class="icon">ğŸ”§</span>ãƒªã‚½ãƒ¼ã‚¹ç®¡ç†</h3>
                    <p><span class="highlight">wait_for_resources()</span></p>
                    <p>â€¢ CPUä½¿ç”¨ç‡ç›£è¦–</p>
                    <p>â€¢ ãƒ¡ãƒ¢ãƒªåŠ¹ç‡åŒ–</p>
                    <p>â€¢ ã‚°ãƒ¬ãƒ¼ã‚¹ãƒ•ãƒ«ã‚·ãƒ£ãƒƒãƒˆãƒ€ã‚¦ãƒ³</p>
                </div>
                
                <div class="component" onclick="showCode('errorHandling')">
                    <h3><span class="icon">ğŸ›¡ï¸</span>ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°</h3>
                    <p><span class="highlight">cleanup_on_exit()</span></p>
                    <p>â€¢ æ®µéšçš„ä¾‹å¤–å‡¦ç†</p>
                    <p>â€¢ ãƒ­ã‚°ãƒ™ãƒ¼ã‚¹çŠ¶æ…‹è¿½è·¡</p>
                    <p>â€¢ è‡ªå‹•å¾©æ—§æ©Ÿèƒ½</p>
                </div>
                
                <div class="component" onclick="showCode('cliInterface')">
                    <h3><span class="icon">ğŸ’»</span>CLIã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹</h3>
                    <p><span class="highlight">display_cli()</span></p>
                    <p>â€¢ ã‚·ãƒ³ãƒ—ãƒ«ãƒ¡ãƒ‹ãƒ¥ãƒ¼</p>
                    <p>â€¢ ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ ãƒ­ã‚°è¡¨ç¤º</p>
                    <p>â€¢ å¯¾è©±çš„æ“ä½œ</p>
                </div>
            </div>
        </div>

        <!-- è¨­å®šãƒ•ã‚¡ã‚¤ãƒ«è©³ç´° -->
        <div class="component-details">
            <h2>âš™ï¸ è¨­å®šãƒ•ã‚¡ã‚¤ãƒ«ï¼ˆconfig.jsonï¼‰</h2>
            <div class="code-example">
{
    "input_folder": "input",
    "output_folder": "output",
    "archive_folder": "archive",
    "whisper_model": "large",
    "compute_type": "int8",      // int8ï¼ˆé«˜é€Ÿï¼‰ã¾ãŸã¯fp16ï¼ˆé«˜ç²¾åº¦ï¼‰
    "language": "ja",
    "max_concurrent_files": 3,
    "max_cpu_percent": 95,
    "scan_interval": 30          // åˆ†å˜ä½
}</div>
            <div class="tech-grid" style="margin-top: 20px;">
                <div class="tech-item">
                    <h4>compute_typeè¨­å®š</h4>
                    <p><strong>int8:</strong> CPUå‡¦ç†ã«æœ€é©åŒ–ã€ãƒ¡ãƒ¢ãƒªåŠ¹ç‡çš„<br>
                    <strong>fp16:</strong> ã‚ˆã‚Šé«˜ç²¾åº¦ã€GPUä½¿ç”¨æ™‚æ¨å¥¨</p>
                </div>
                <div class="tech-item">
                    <h4>whisper_modelè¨­å®š</h4>
                    <p><strong>large:</strong> æœ€é«˜ç²¾åº¦ï¼ˆæ¨å¥¨ï¼‰<br>
                    <strong>medium/small:</strong> é«˜é€Ÿå‡¦ç†å„ªå…ˆæ™‚</p>
                </div>
            </div>
        </div>

        <!-- è¨­è¨ˆãƒ‘ã‚¿ãƒ¼ãƒ³ -->
        <div class="component-details">
            <h2>ğŸ¯ æ¡ç”¨ã•ã‚ŒãŸè¨­è¨ˆãƒ‘ã‚¿ãƒ¼ãƒ³</h2>
            <div class="tech-grid">
                <div class="tech-item">
                    <h4>ğŸ“¤ Producer-Consumer ãƒ‘ã‚¿ãƒ¼ãƒ³</h4>
                    <p>ãƒ•ã‚¡ã‚¤ãƒ«ç›£è¦–ï¼ˆProducerï¼‰ã¨å‡¦ç†å®Ÿè¡Œï¼ˆConsumerï¼‰ã®åˆ†é›¢</p>
                </div>
                <div class="tech-item">
                    <h4>ğŸ”„ State Machine ãƒ‘ã‚¿ãƒ¼ãƒ³</h4>
                    <p>ãƒ•ã‚¡ã‚¤ãƒ«å‡¦ç†çŠ¶æ…‹ã®ç®¡ç†ï¼ˆå¾…æ©Ÿâ†’å‡¦ç†ä¸­â†’å®Œäº†â†’ã‚¢ãƒ¼ã‚«ã‚¤ãƒ–ï¼‰</p>
                </div>
                <div class="tech-item">
                    <h4>ğŸ›ï¸ Strategy ãƒ‘ã‚¿ãƒ¼ãƒ³</h4>
                    <p>è¨­å®šãƒ•ã‚¡ã‚¤ãƒ«ã«ã‚ˆã‚‹å‹•ä½œã‚«ã‚¹ã‚¿ãƒã‚¤ã‚ºï¼ˆcompute_typeã€ãƒ¢ãƒ‡ãƒ«ã‚µã‚¤ã‚ºç­‰ï¼‰</p>
                </div>
                <div class="tech-item">
                    <h4>ğŸ”’ Singleton ãƒ‘ã‚¿ãƒ¼ãƒ³</h4>
                    <p>Whisperãƒ¢ãƒ‡ãƒ«ã®å˜ä¸€ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ç®¡ç†</p>
                </div>
            </div>
        </div>
    </div>

    <!-- ãƒ¢ãƒ¼ãƒ€ãƒ« -->
    <div id="modal" class="modal">
        <div class="modal-content">
            <span class="close" onclick="closeModal()">&times;</span>
            <h3 id="modal-title"></h3>
            <div id="modal-body"></div>
        </div>
    </div>

    <script>
        function showDetail(component) {
            const details = {
                'input': {
                    title: 'ğŸ“ INPUT ãƒ•ã‚©ãƒ«ãƒ€',
                    content: `
                        <p><strong>å½¹å‰²:</strong> éŸ³å£°ãƒ»å‹•ç”»ãƒ•ã‚¡ã‚¤ãƒ«ã®å…¥åŠ›ç‚¹</p>
                        <div class="code-example">
# å¯¾å¿œãƒ•ã‚¡ã‚¤ãƒ«å½¢å¼
media_extensions = (
    '.mp3', '.mp4', '.wav', '.m4a', 
    '.mov', '.avi', '.flac', '.ogg', '.aac'
)</div>
                        <p><strong>ç‰¹å¾´:</strong></p>
                        <ul>
                            <li>ãƒ‰ãƒ©ãƒƒã‚°&ãƒ‰ãƒ­ãƒƒãƒ—ã§ãƒ•ã‚¡ã‚¤ãƒ«é…ç½®</li>
                            <li>è¤‡æ•°ãƒ•ã‚¡ã‚¤ãƒ«åŒæ™‚å‡¦ç†å¯¾å¿œ</li>
                            <li>å¤§å®¹é‡ãƒ•ã‚¡ã‚¤ãƒ«å¯¾å¿œ</li>
                        </ul>
                    `
                },
                'scanner': {
                    title: 'ğŸ” ãƒ•ã‚¡ã‚¤ãƒ«ç›£è¦–ã‚·ã‚¹ãƒ†ãƒ ',
                    content: `
                        <p><strong>ç›£è¦–æ–¹å¼:</strong> å®šæœŸãƒãƒ¼ãƒªãƒ³ã‚°ï¼ˆ30åˆ†é–“éš”ï¼‰</p>
                        <div class="code-example">
def scan_and_queue_files():
    for file in os.listdir(input_folder):
        if file.lower().endswith(media_extensions):
            if not is_file_queued_or_processing(file_path):
                processing_queue.append(file_info)</div>
                        <p><strong>æ©Ÿèƒ½:</strong></p>
                        <ul>
                            <li>æ–°è¦ãƒ•ã‚¡ã‚¤ãƒ«è‡ªå‹•æ¤œå‡º</li>
                            <li>é‡è¤‡å‡¦ç†é˜²æ­¢</li>
                            <li>ãƒ•ã‚¡ã‚¤ãƒ«æƒ…å ±ãƒ¡ã‚¿ãƒ‡ãƒ¼ã‚¿ä»˜ä¸</li>
                        </ul>
                    `
                },
                'queue': {
                    title: 'ğŸ“‹ å‡¦ç†ã‚­ãƒ¥ãƒ¼ã‚·ã‚¹ãƒ†ãƒ ',
                    content: `
                        <p><strong>ãƒ‡ãƒ¼ã‚¿æ§‹é€ :</strong> Python Listï¼ˆFIFOï¼‰</p>
                        <div class="code-example">
file_info = {
    "path": file_path,
    "name": file_name,
    "size": file_size,
    "queued_at": timestamp
}</div>
                        <p><strong>åˆ¶å¾¡æ©Ÿèƒ½:</strong></p>
                        <ul>
                            <li>åŒæ™‚å‡¦ç†æ•°åˆ¶é™ï¼ˆãƒ‡ãƒ•ã‚©ãƒ«ãƒˆ3ä»¶ï¼‰</li>
                            <li>å‡¦ç†çŠ¶æ…‹ç®¡ç†</li>
                            <li>å„ªå…ˆåº¦åˆ¶å¾¡</li>
                        </ul>
                    `
                },
                'whisper': {
                    title: 'ğŸ¤– WhisperéŸ³å£°èªè­˜ã‚¨ãƒ³ã‚¸ãƒ³',
                    content: `
                        <p><strong>å®Ÿè£…:</strong> faster-whisperï¼ˆCTranslate2ãƒ™ãƒ¼ã‚¹ï¼‰</p>
                        <div class="code-example">
model = WhisperModel("large", compute_type="int8")
segments, info = model.transcribe(
    file_path, 
    language="ja", 
    beam_size=5
)</div>
                        <p><strong>æœ€é©åŒ–:</strong></p>
                        <ul>
                            <li>é‡å­åŒ–ï¼ˆINT8/FP16ï¼‰ã«ã‚ˆã‚‹ãƒ¡ãƒ¢ãƒªåŠ¹ç‡åŒ–</li>
                            <li>config.jsonã§compute_typeè¨­å®šå¯èƒ½</li>
                            <li>ãƒ¢ãƒ‡ãƒ«å†åˆ©ç”¨ã§ãƒ­ãƒ¼ãƒ‰æ™‚é–“çŸ­ç¸®</li>
                            <li>VADãƒ•ã‚£ãƒ«ã‚¿ã§ç²¾åº¦å‘ä¸Š</li>
                        </ul>
                    `
                },
                'output': {
                    title: 'ğŸ“„ OUTPUT ãƒ•ã‚©ãƒ«ãƒ€',
                    content: `
                        <p><strong>å‡ºåŠ›å½¢å¼:</strong> UTF-8ãƒ†ã‚­ã‚¹ãƒˆãƒ•ã‚¡ã‚¤ãƒ«</p>
                        <div class="code-example">
# ãƒ•ã‚¡ã‚¤ãƒ«åä¾‹
input:  meeting_2025-05-22.mp3
output: meeting_2025-05-22.txt</div>
                        <p><strong>ç‰¹å¾´:</strong></p>
                        <ul>
                            <li>å…ƒãƒ•ã‚¡ã‚¤ãƒ«åãƒ™ãƒ¼ã‚¹ã®å‘½å</li>
                            <li>æ–‡å­—åŒ–ã‘é˜²æ­¢ï¼ˆUTF-8ï¼‰</li>
                            <li>ã‚»ã‚°ãƒ¡ãƒ³ãƒˆåŒºåˆ‡ã‚Šã§ã®å‡ºåŠ›</li>
                        </ul>
                    `
                },
                'archive': {
                    title: 'ğŸ—ƒï¸ ARCHIVE ãƒ•ã‚©ãƒ«ãƒ€',
                    content: `
                        <p><strong>å½¹å‰²:</strong> å‡¦ç†å®Œäº†ãƒ•ã‚¡ã‚¤ãƒ«ã®ä¿ç®¡</p>
                        <div class="code-example">
def safe_move_file(source, destination):
    # åŒåãƒ•ã‚¡ã‚¤ãƒ«å­˜åœ¨æ™‚ã¯è‡ªå‹•ãƒªãƒãƒ¼ãƒ 
    if dest_path.exists():
        new_name = f"{stem}_{counter}{suffix}"</div>
                        <p><strong>æ©Ÿèƒ½:</strong></p>
                        <ul>
                            <li>åŒåãƒ•ã‚¡ã‚¤ãƒ«è‡ªå‹•ãƒªãƒãƒ¼ãƒ </li>
                            <li>å®‰å…¨ãªãƒ•ã‚¡ã‚¤ãƒ«ç§»å‹•</li>
                            <li>ãƒ‡ã‚£ã‚¹ã‚¯å®¹é‡ç®¡ç†</li>
                        </ul>
                    `
                }
            };
            
            const detail = details[component];
            if (detail) {
                document.getElementById('modal-title').innerHTML = detail.title;
                document.getElementById('modal-body').innerHTML = detail.content;
                document.getElementById('modal').style.display = 'block';
            }
        }

        function showCode(component) {
            const codeExamples = {
                'fileWatcher': {
                    title: 'ğŸ‘ï¸ ãƒ•ã‚¡ã‚¤ãƒ«ç›£è¦–ã‚·ã‚¹ãƒ†ãƒ å®Ÿè£…',
                    content: `
                        <div class="code-example">
def scan_and_queue_files():
    """å…¥åŠ›ãƒ•ã‚©ãƒ«ãƒ€ã‚’ã‚¹ã‚­ãƒ£ãƒ³ã—ã¦ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ã‚­ãƒ¥ãƒ¼ã«è¿½åŠ """
    input_folder = config.get("input_folder")
    media_extensions = ('.mp3', '.mp4', '.wav', '.m4a', 
                       '.mov', '.avi', '.flac', '.ogg', '.aac')
    
    new_files = []
    for file in os.listdir(input_folder):
        file_path = os.path.join(input_folder, file)
        
        if (os.path.isfile(file_path) and 
            file.lower().endswith(media_extensions) and
            not is_file_queued_or_processing(file_path)):
            
            new_files.append(file_path)
    
    for file_path in new_files:
        file_info = {
            "path": file_path,
            "name": os.path.basename(file_path),
            "size": os.path.getsize(file_path),
            "queued_at": time.strftime("%Y-%m-%d %H:%M:%S")
        }
        processing_queue.append(file_info)</div>
                        <p><strong>ãƒã‚¤ãƒ³ãƒˆ:</strong></p>
                        <ul>
                            <li>æ‹¡å¼µå­ãƒ•ã‚£ãƒ«ã‚¿ãƒªãƒ³ã‚°ã§å¯¾è±¡ãƒ•ã‚¡ã‚¤ãƒ«ã®ã¿å‡¦ç†</li>
                            <li>é‡è¤‡å‡¦ç†ãƒã‚§ãƒƒã‚¯ã§ãƒªã‚½ãƒ¼ã‚¹åŠ¹ç‡åŒ–</li>
                            <li>ãƒ¡ã‚¿ãƒ‡ãƒ¼ã‚¿ä»˜ãã§ãƒˆãƒ¬ãƒ¼ã‚µãƒ“ãƒªãƒ†ã‚£ç¢ºä¿</li>
                        </ul>
                    `
                },
                'queueManager': {
                    title: 'ğŸ“Š ã‚­ãƒ¥ãƒ¼ç®¡ç†ã‚·ã‚¹ãƒ†ãƒ ',
                    content: `
                        <div class="code-example">
def process_next_file():
    """ã‚­ãƒ¥ãƒ¼ã®æ¬¡ã®ãƒ•ã‚¡ã‚¤ãƒ«ã‚’å‡¦ç†"""
    if not processing_queue:
        return False
    
    # ãƒªã‚½ãƒ¼ã‚¹ä½¿ç”¨çŠ¶æ³ç¢ºèª
    if not wait_for_resources():
        return False
    
    # åŒæ™‚å‡¦ç†æ•°ç¢ºèª
    max_concurrent = config.get("max_concurrent_files", 3)
    if len(files_in_process) >= max_concurrent:
        return False
    
    # æ¬¡ã®ãƒ•ã‚¡ã‚¤ãƒ«ã‚’å–å¾—
    file_info = processing_queue.pop(0)
    return process_file(file_info["path"])</div>
                        <p><strong>åˆ¶å¾¡æ©Ÿèƒ½:</strong></p>
                        <ul>
                            <li>FIFOæ–¹å¼ã§é †åºå‡¦ç†ä¿è¨¼</li>
                            <li>CPUä½¿ç”¨ç‡ãƒ™ãƒ¼ã‚¹ã®ãƒªã‚½ãƒ¼ã‚¹åˆ¶å¾¡</li>
                            <li>è¨­å®šå¯èƒ½ãªåŒæ™‚å‡¦ç†æ•°åˆ¶é™</li>
                        </ul>
                    `
                },
                'whisperIntegration': {
                    title: 'ğŸ¤ Whisperçµ±åˆå®Ÿè£…',
                    content: `
                        <div class="code-example">
def transcribe_audio(file_path):
    """éŸ³å£°ãƒ•ã‚¡ã‚¤ãƒ«ã‚’æ–‡å­—èµ·ã“ã—"""
    from faster_whisper import WhisperModel
    
    model_size = config.get("whisper_model", "large")
    compute_type = config.get("compute_type", "int8")
    
    # ãƒ¢ãƒ‡ãƒ«åŠ¹ç‡çš„ç®¡ç†
    if (whisper_model is None or 
        model_config != (model_size, compute_type)):
        whisper_model = WhisperModel(model_size, 
                                   compute_type=compute_type)
        model_config = (model_size, compute_type)
    
    # æ–‡å­—èµ·ã“ã—å®Ÿè¡Œ
    segments, info = whisper_model.transcribe(
        file_path,
        language=config.get("language", "ja"),
        beam_size=5,
        best_of=5,
        vad_filter=True
    )
    
    return "\\n".join([seg.text.strip() for seg in segments])</div>
                        <p><strong>æœ€é©åŒ–æŠ€è¡“:</strong></p>
                        <ul>
                            <li>ãƒ¢ãƒ‡ãƒ«å†åˆ©ç”¨ã§ãƒ¡ãƒ¢ãƒªåŠ¹ç‡åŒ–</li>
                            <li>INT8/FP16é‡å­åŒ–ã§é«˜é€ŸåŒ–ï¼ˆconfig.jsonã§é¸æŠå¯èƒ½ï¼‰</li>
                            <li>VADãƒ•ã‚£ãƒ«ã‚¿ã§ç²¾åº¦å‘ä¸Š</li>
                        </ul>
                    `
                },
                'resourceManager': {
                    title: 'ğŸ”§ ãƒªã‚½ãƒ¼ã‚¹ç®¡ç†ã‚·ã‚¹ãƒ†ãƒ ',
                    content: `
                        <div class="code-example">
def wait_for_resources(max_wait_seconds=5):
    """ãƒªã‚½ãƒ¼ã‚¹ãŒåˆ©ç”¨å¯èƒ½ã«ãªã‚‹ã¾ã§å¾…æ©Ÿ"""
    import psutil
    
    max_cpu = config.get("max_cpu_percent", 95)
    start_time = time.time()
    
    while time.time() - start_time < max_wait_seconds:
        if stop_requested:
            return False
            
        cpu_percent = psutil.cpu_percent(interval=1)
        
        if cpu_percent <= max_cpu:
            return True
            
        time.sleep(1)
    
    return False  # ã‚¿ã‚¤ãƒ ã‚¢ã‚¦ãƒˆ

# ã‚°ãƒ¬ãƒ¼ã‚¹ãƒ•ãƒ«ã‚·ãƒ£ãƒƒãƒˆãƒ€ã‚¦ãƒ³
def cleanup_on_exit():
    global stop_requested, is_running
    stop_requested = True
    is_running = False
    
    if processing_thread and processing_thread.is_alive():
        processing_thread.join(timeout=10)</div>
                        <p><strong>åˆ¶å¾¡æ©Ÿèƒ½:</strong></p>
                        <ul>
                            <li>CPUä½¿ç”¨ç‡ç›£è¦–ã¨å‡¦ç†åˆ¶å¾¡</li>
                            <li>å®‰å…¨ãªçµ‚äº†å‡¦ç†</li>
                            <li>ã‚¿ã‚¤ãƒ ã‚¢ã‚¦ãƒˆä»˜ããƒªã‚½ãƒ¼ã‚¹å¾…æ©Ÿ</li>
                        </ul>
                    `
                },
                'errorHandling': {
                    title: 'ğŸ›¡ï¸ ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°æˆ¦ç•¥',
                    content: `
                        <div class="code-example">
# ã‚·ã‚°ãƒŠãƒ«ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°
signal.signal(signal.SIGTERM, signal_handler)
signal.signal(signal.SIGINT, signal_handler)
atexit.register(cleanup_on_exit)

def process_file(file_path):
    try:
        files_in_process.add(file_path)
        
        # å‡¦ç†å®Ÿè¡Œ
        transcription = transcribe_audio(file_path)
        
        if transcription:
            # æˆåŠŸæ™‚ã®å‡¦ç†
            save_output(transcription)
            archive_file(file_path)
        else:
            log_and_print(f"å‡¦ç†å¤±æ•—: {file_name}", "error")
            
    except Exception as e:
        log_and_print(f"ã‚¨ãƒ©ãƒ¼ç™ºç”Ÿ: {e}", "error")
    finally:
        # å¿…ãšã‚¯ãƒªãƒ¼ãƒ³ã‚¢ãƒƒãƒ—
        if file_path in files_in_process:
            files_in_process.remove(file_path)</div>
                        <p><strong>ã‚¨ãƒ©ãƒ¼æˆ¦ç•¥:</strong></p>
                        <ul>
                            <li>æ®µéšçš„ä¾‹å¤–ã‚­ãƒ£ãƒƒãƒ</li>
                            <li>1ãƒ•ã‚¡ã‚¤ãƒ«å¤±æ•—ã§å…¨ä½“åœæ­¢ã—ãªã„è¨­è¨ˆ</li>
                            <li>ç¢ºå®Ÿãªãƒªã‚½ãƒ¼ã‚¹ã‚¯ãƒªãƒ¼ãƒ³ã‚¢ãƒƒãƒ—</li>
                        </ul>
                    `
                },
                'cliInterface': {
                    title: 'ğŸ’» CLI ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹',
                    content: `
                        <div class="code-example">
def display_cli():
    """CLIã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹ã‚’è¡¨ç¤º"""
    while True:
        clear_screen()
        display_menu()
        
        # ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ ãƒ­ã‚°è¡¨ç¤º
        print("\\næœ€æ–°ãƒ­ã‚°:")
        print("-" * 40)
        show_recent_logs(10)
        print("-" * 40)
        
        choice = input("\\né¸æŠ> ")
        
        if choice == "1":
            if start_processing():
                print("å‡¦ç†ã‚’é–‹å§‹ã—ã¾ã—ãŸ")
            else:
                print("ã™ã§ã«å®Ÿè¡Œä¸­ã§ã™")
        elif choice == "2":
            # è¨­å®šè¡¨ç¤º
            for key, value in config.items():
                print(f"{key}: {value}")

def show_recent_logs(lines=10):
    """æœ€æ–°ã®ãƒ­ã‚°ã‚’è¡¨ç¤º"""
    with open('koemoji.log', 'rb') as f:
        # æœ«å°¾ã‹ã‚‰èª­ã¿è¾¼ã¿
        f.seek(0, 2)
        file_size = f.tell()
        read_size = min(10240, file_size)
        f.seek(max(0, file_size - read_size), 0)
        
        data = f.read()
        text = data.decode('utf-8')
        recent_lines = text.splitlines()[-lines:]
        
        for line in recent_lines:
            print(line.strip())</div>
                        <p><strong>UIç‰¹å¾´:</strong></p>
                        <ul>
                            <li>ã‚·ãƒ³ãƒ—ãƒ«ãªãƒ¡ãƒ‹ãƒ¥ãƒ¼å‹æ“ä½œ</li>
                            <li>ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ ãƒ­ã‚°è¡¨ç¤º</li>
                            <li>ã‚¨ãƒ³ã‚³ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°å¯¾å¿œ</li>
                        </ul>
                    `
                }
            };
            
            const example = codeExamples[component];
            if (example) {
                document.getElementById('modal-title').innerHTML = example.title;
                document.getElementById('modal-body').innerHTML = example.content;
                document.getElementById('modal').style.display = 'block';
            }
        }

        function closeModal() {
            document.getElementById('modal').style.display = 'none';
        }

        // ãƒ¢ãƒ¼ãƒ€ãƒ«å¤–ã‚¯ãƒªãƒƒã‚¯ã§é–‰ã˜ã‚‹
        window.onclick = function(event) {
            const modal = document.getElementById('modal');
            if (event.target == modal) {
                modal.style.display = 'none';
            }
        }
    </script>
</body>
</html>